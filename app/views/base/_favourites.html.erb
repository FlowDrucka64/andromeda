<% if not @favourites.empty? %>
  <%= form_with(url: get_fav_url, method: :get) do |f| %>
    <%= f.select :sort, [['Title A-Z',1],['Date',2],['Date Reverse',3]], :selected => params[:sort] %>
    <%= f.submit "Sort", :class => "small", :name => nil%>
    <%= f.hidden_field(:p,:value => 1)  %>
  <% end %>

  <h2>
    <% if @favourites["objects"].length > 0 %>
      <%= @favourites["objects"].length %> favourite<%= @favourites["objects"].length > 1 ? "s" : "" %> found !
    <% else %>
      That's where I'd put my favourites... IF I HAD ANY
    <% end %>
  </h2>
  <% case params[:sort] %>
  <% when "1" %>
    <ul>
      <% @favourites["slice"].sort_by{ |h| h["sort_title"]}.each do |f| %>
        <li>
          <%= render 'favourite_result', favourite: f %>
        </li>
      <% end %>
    </ul>
  <% when "2" %>
    <ul>
      <% @favourites["slice"].sort_by{ |h| h[:date]}.each do |f| %>
        <li>
          <%= render 'favourite_result', favourite: f %>
        </li>
      <% end %>
    </ul>

  <% when "3" %>
    <ul>
      <% @favourites["slice"].sort_by{ |h| h[:date]}.reverse.each do |f| %>
        <li>
          <%= render 'favourite_result', favourite: f %>
        </li>
      <% end %>
    </ul>
  <% else %>
    <ul>
      <% @favourites["slice"].sort_by{ |h| h["sort_title"]}.each do |f| %>
        <li>
          <%= render 'favourite_result', favourite: f %>
        </li>
      <% end %>
    </ul>
  <% end %>



  <% if @favourites["objects"].length > PAGE_ENTRY_COUNT %>
    <tr>
      <% if params[:p].to_i > 1 %>
        <%= link_to "[Previous]", staff_favourites_url(p: params[:p].to_i - 1) %>
      <% end %>
      <% for i in 1..@favourites["page_count"] do %>
        <%= link_to "[Page #{i}]", staff_favourites_url(p: i) %>
      <% end %>
      <% if params[:p].to_i < @favourites["page_count"] %>
        <%= link_to "[Next]", staff_favourites_url(p: params[:p].to_i + 1) %>
      <% end %>
    </tr>
  <% end %>


<% else %>
  <ul>
    Sorry no results yet!
  </ul>
<% end %>




<br>
<%= render 'footer' %>

